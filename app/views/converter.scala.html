
@*
* This template takes a single argument, a String containing a
* message to display.
*@
@(message: String)

@*
* Call the `main` template with two arguments. The first
* argument is a `String` with the title of the page, the second
* argument is an `Html` object containing the body of the page.
*@
@main("Welcome to Play") {
    @*
    * Get an `Html` object by calling the built-in Play welcome
    * template and passing a `String` message.
    *@
    @*
    @play20.welcome(message, style = "Scala")
    *@
    <div id = "logo">
        <img src="@routes.Assets.versioned("images/Jasmine.png")" width="300" height="88">
    </div>
    <div clsee="row">
        @*CodeArea(ACE)*@
        <div class="btn-group">
            @*<div class="btn-group">*@
                @*<button class="btn btn-default dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-search"></i> <span class="caret"></span></button>*@
                @*<ul class="dropdown-menu" id="font-size">*@
                    @*<li><a href="#" data-size="10">小さい</a></li>*@
                    @*<li><a href="#" data-size="12">普通</a></li>*@
                    @*<li><a href="#" data-size="14">大きい</a></li>*@
                @*</ul>*@
            @*</div>*@
            @*<button id="bold" class="btn btn-default"><i class="glyphicon glyphicon-bold"></i></button>*@
            @*<button id="save" class="btn btn-default"><i class="glyphicon glyphicon-floppy-save"></i></button>*@
            @*<button id="load" class="btn btn-default"><i class="glyphicon glyphicon-folder-open"></i></button>*@
            <button id="exec" class="btn btn-default"><i class="glyphicon glyphicon-play"></i></button>
            @*<button id="step" class="btn btn-default"><i class="glyphicon glyphicon-arrow-down"></i></button>*@
        </div>
    </div>
    <div class="col-lg-6 col-md-6">
        Java
        <div id="editorMain" style="height: 600px"></div>
    </div>
    <div class="col-lg-6 col-md-6">
        Swift(ReadOnly)
        <div id="editorResult" style="height: 600px"></div>
    </div>
    @*処理の流れ<br>*@
    @*実行ボタン：JavaScriptでイベント取得。エディタ上のテキストを取得。Fromの形でPOST(JavaScript)<br>*@
    @*コントローラはポストされたデータを取得。アクション関数で文字列の処理など。(Scala,String)ビューにセット。<br>*@
    @*ビュー：生文字を取得(改行文字に注意)。JavaScriptでコメント文字など操作してセット。<br>*@
    <script>

        function createEditor(idName,canWrite,initText,mode) {
            var editor = ace.edit(idName);
            if (canWrite) {
                editor.$blockScrolling = Infinity;
                editor.setOptions({
                    enableBasicAutocompletion: true,//基本的な自動補完
                    enableSnippets: true,//スニペット
                    enableLiveAutocompletion: true//ライブ補完
                });
            }
            editor.setTheme("ace/theme/monokai");
            editor.getSession().setMode("ace/mode/"+mode);//シンタックスハイライトと自動補完
            //editor.getSession().setUseWrapMode(true);//true:折り返し、false:横スクロールバー

            //2の場合編集不可能オプションをtrueにしたい。ｌ

            $('#font-size').click(function (e) {
                editor.setFontSize($(e.target).data('size'));
            });

            editor.setReadOnly(!canWrite);
            if (canWrite) {
                $('#exec').click(function (e) {
                    var form = document.createElement('form');
                    document.body.appendChild(form);
                    var input = document.createElement('input');
                    input.setAttribute('type', 'hidden');
                    input.setAttribute('name', 'name');
                    var text = editor.getValue();
//                    text = text.split(`"`).join(`"`);
                    localStorage.text = text;
                    input.setAttribute('value', text);
                    form.appendChild(input);
                    form.setAttribute('action', '/converter');
                    form.setAttribute('method', 'POST');
                    form.submit();
                });

                $('#step').click(function (e) {
                    //var obj = editor.getCursorPosition();
                    //var pos = editor.getCursorPositionScreen();
                    var curpos = editor.getSelection().getCursor();
                    editor.gotoLine(curpos.row+2 , curpos.column); //1行列目が1
                });
            }


            if (initText != '')
                editor.setValue(initText, -1);
        }
        var mes =`@Html(message)`;
        var mes1 = mes.replace( /<br>/g , `
`) ;
        var mes2 =  mes.replace( /<br>/g , `
//`) ;
        if(mes2 == "NULL_POINTER"){
            alert("Error in the Java Program");
            mes2 = "";
        }
        createEditor('editorMain',true,localStorage.text,"java");
        createEditor('editorResult',false,mes2,"swift");
    </script>
}
